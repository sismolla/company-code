{% extends 'base2.html' %}
{% load static %}
{% block meta %}
<meta name="description" content="Reach out to Pharma ገበያ for inquiries, partnerships, or support. We connect pharmaceutical wholesalers with pharmacies and bulk buyers across Ethiopia." />
{% endblock meta %}
{% block title %}
Contact Us
{% endblock title %}

{% block style %}

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc;
        }
        .contact-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .contact-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
        }
            .image-container {
        /* Container styling for a clean, modern look */
        max-width: 900px;
        margin: 40px auto;
        padding: 20px;
        background-color: #ffffff;
        border-radius: 12px;
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .image-container img {
        /* Make the image responsive and fit the container */
        max-width: 100%;
        height: auto;
        display: block;
        border-radius: 8px; /* Slightly rounded corners for the image itself */
    }

    /* Optional: Style the original class just in case you use it elsewhere */
    .map-container {
        display: flex;
        justify-content: center;
        align-items: center;
        margin-bottom: 2rem;
    }

        
        .form-input:focus {
            outline: none;
            ring: 2px;
            ring-color: #3498db;
            border-color: #3498db;
        }
        .highlight-text {
            background: linear-gradient(135deg, #3498db 0%, #3498f0ff 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 700;
        }
    </style>
{% endblock style %}

{% block content %}
    <!-- Hero Section -->
    <section class="py-16 bg-gradient-to-r from-blue-50 to-indigo-50">
        <div class="container mx-auto px-4 text-center">
            <h1 class="text-4xl md:text-5xl font-bold text-gray-900 mb-6">Get in <span class="highlight-text">Touch</span></h1>
            <p class="text-xl text-gray-700 max-w-3xl mx-auto">Have questions about showcasing your pharmaceutical products? We're here to help you connect with buyers across Ethiopia.</p>
        </div>
    </section>

    <!-- Contact Cards -->
    <section class="py-16">
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div class="contact-card bg-white p-8 rounded-xl shadow-sm text-center">
                <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-6">
                    <i class="fas fa-clock text-blue-600 text-2xl"></i>
                </div>
                <h3 class="text-xl font-semibold text-gray-900 mb-4">Working Hours</h3>
                <p class="text-gray-600">
                    Monday - Friday: 9:00 AM - 5:00 PM<br>
                    Saturday: 9:00 AM - 1:00 PM<br>
                    Sunday: Closed
                </p>
            </div>
                <div class="contact-card bg-white p-8 rounded-xl shadow-sm text-center">
                    <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-6">
                        <i class="fas fa-phone-alt text-blue-600 text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-900 mb-4">Phone Number</h3>
                    <p class="text-gray-600">+251 97 853 9445<br>+251 94 181 2829 </p>
                </div>
                <div class="contact-card bg-white p-8 rounded-xl shadow-sm text-center">
                    <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-6">
                        <i class="fas fa-envelope text-blue-600 text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-900 mb-4">Email Address</h3>
                    <p class="text-gray-600">info@pharmagebay.com<br>support@pharmagebay.com</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Contact Form & Map -->
    <section class="py-16 bg-gray-100">
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-12">
                <!-- Contact Form -->
                <div>
                    <h2 class="text-3xl font-bold text-gray-900 mb-6">Send Us a <span class="highlight-text">Message</span></h2>
                    <form class="bg-white p-8 rounded-xl shadow-sm">
                        <div class="mb-6">
                            <label for="name" class="block text-gray-700 font-medium mb-2">Full Name</label>
                            <input type="text" id="name" class="w-full px-4 py-3 border border-gray-300 rounded-lg form-input focus:border-blue-500 focus:ring-1 focus:ring-blue-500" placeholder="Your name">
                        </div>
                        <div class="mb-6">
                            <label for="email" class="block text-gray-700 font-medium mb-2">Email Address</label>
                            <input type="email" id="email" class="w-full px-4 py-3 border border-gray-300 rounded-lg form-input focus:border-blue-500 focus:ring-1 focus:ring-blue-500" placeholder="Your email address">
                        </div>
                        <div class="mb-6">
                            <label for="subject" class="block text-gray-700 font-medium mb-2">Subject</label>
                            <select id="subject" class="w-full px-4 py-3 border border-gray-300 rounded-lg form-input focus:border-blue-500 focus:ring-1 focus:ring-blue-500">
                                <option value="">Select a subject</option>
                                <option value="wholesaler">Become a Featured Wholesaler</option>
                                <option value="buyer">Buyer Inquiry</option>
                                <option value="partnership">Partnership Opportunity</option>
                                <option value="support">Technical Support</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        <div class="mb-6">
                            <label for="message" class="block text-gray-700 font-medium mb-2">Message</label>
                            <textarea id="message" rows="5" class="w-full px-4 py-3 border border-gray-300 rounded-lg form-input focus:border-blue-500 focus:ring-1 focus:ring-blue-500" placeholder="You can write a Maximum of 2000 characters"></textarea>
                        </div>
                        <button type="submit" class="w-full bg-blue-600 text-white font-medium py-3 px-6 rounded-lg hover:bg-blue-700 transition-colors">
                            Send Message
                        </button>
                    </form>
                </div>

                <!-- Map & Additional Info -->
                <div>
                    <h2 class="text-3xl font-bold text-gray-900 mb-6">Our <span class="highlight-text">Working Time</span></h2>
                    {% comment %} <div class="map-container mb-8">
                        <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d126766.33125140039!2d38.6968128!3d9.010787!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x164b85cef5ab402d%3A0x8467b6b037a24d49!2sAddis%20Ababa%2C%20Ethiopia!5e0!3m2!1sen!2sus!4v1700000000000!5m2!1sen!2sus" width="100%" height="300" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                    </div> {% endcomment %}

                    <div class="bg-white p-8 rounded-xl shadow-sm">
                        <h3 class="text-xl font-semibold text-gray-900 mb-4">Business Hours</h3>
                        <ul class="space-y-3">
                            <li class="flex justify-between">
                                <span class="text-gray-600">Monday - Friday</span>
                                <span class="font-medium">8:30 AM - 5:30 PM</span>
                            </li>
                            <li class="flex justify-between">
                                <span class="text-gray-600">Saturday</span>
                                <span class="font-medium">9:00 AM - 2:00 PM</span>
                            </li>
                            <li class="flex justify-between">
                                <span class="text-gray-600">Sunday</span>
                                <span class="font-medium">Closed</span>
                            </li>
                        </ul>

                        <h3 class="text-xl font-semibold text-gray-900 mt-8 mb-4">Emergency Support</h3>
                        <p class="text-gray-600 mb-4">For urgent matters outside business hours, please call:</p>
                        <p class="text-blue-600 font-medium">+251 97 853 9445</p>
                    </div>

                    <div class="image-container">
                        <img src="{% static 'image.png' %}" alt="Pharma Gebeya Logo">
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- FAQ Preview -->
    <section class="py-16">
        <div class="container mx-auto px-4">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-gray-900 mb-4">Common <span class="highlight-text">Questions</span></h2>
                <p class="text-xl text-gray-700">Quick answers to frequently asked questions</p>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 max-w-4xl mx-auto">
                <div class="bg-white p-6 rounded-xl shadow-sm">
                    <h3 class="text-lg font-semibold text-gray-900 mb-3">How do I become a featured wholesaler?</h3>
                    <p class="text-gray-600">Contact us through the form, and our team will guide you through the verification and onboarding process to showcase your products.</p>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-sm">
                    <h3 class="text-lg font-semibold text-gray-900 mb-3">Is there a cost to join as a buyer?</h3>
                    <p class="text-gray-600">No, browsing and connecting with wholesalers is completely free for pharmacies and bulk buyers.</p>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-sm">
                    <h3 class="text-lg font-semibold text-gray-900 mb-3">How quickly will I get a response?</h3>
                    <p class="text-gray-600">We typically respond to all inquiries within 24 business hours. For urgent matters, please call our emergency support line.</p>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-sm">
                    <h3 class="text-lg font-semibold text-gray-900 mb-3">Do you serve regions outside Addis Ababa?</h3>
                    <p class="text-gray-600">Yes, we work with wholesalers and buyers across all regions of Ethiopia through our digital platform.</p>
                </div>
            </div>
            <div class="text-center mt-8">
                <a href="http://127.0.0.1:8000/faq" class="inline-flex items-center text-blue-600 font-medium hover:text-blue-800 transition-colors">
                    View All FAQs <i class="fas fa-arrow-right ml-2"></i>
                </a>
            </div>
        </div>
    </section>

    <!-- CTA Section -->
    <section class="py-16 bg-blue-700">
        <div class="container mx-auto px-4 text-center">
            <h2 class="text-3xl font-bold text-white mb-6">Ready to Showcase Your Products?</h2>
            <p class="text-xl text-blue-100 mb-8 max-w-3xl mx-auto">Join Ethiopia's premier platform for Company promotion in the world and become the big brand. connect with buyers across the country</p>
            <div class="flex flex-wrap justify-center gap-4">
                <a href="{% url 'landing:dashboard' %}" class="bg-white text-blue-600 px-6 py-3 rounded-lg font-medium hover:bg-blue-50 transition-colors">Become a Featured Wholesaler</a>
                {% comment %} <a href="#" class="bg-transparent text-white px-6 py-3 rounded-lg font-medium border border-white hover:bg-blue-700 transition-colors">Schedule a Call</a> {% endcomment %}
            </div>
        </div>
    </section>
{% endblock content %}

{% block script %}
<script>
    // === CSRF Helper ===
    function getCookie(name) {
        try {
            let cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                const cookies = document.cookie.split(';');
                for (let i = 0; i < cookies.length; i++) {
                    const cookie = cookies[i].trim();
                    if (cookie.startsWith(name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        } catch (err) {
            console.error("CSRF error:", err);
            return null;
        }
    }

    const csrftoken = getCookie('csrftoken');
    const form = document.querySelector('form');
    const apiUrl = '/api/contactus/';

    if (!form) {
        console.error("❌ Form element not found!");
    }

    // === Notification Helper ===
    function showNotification(message, isSuccess = false) {
        if (!form) return;
        const notification = document.createElement('div');
        notification.className = `p-4 rounded-lg shadow-md text-white font-semibold mb-4 text-center ${isSuccess ? 'bg-green-500' : 'bg-red-500'}`;
        notification.textContent = message;

        // Remove old notifications before showing new
        form.querySelectorAll('.notification').forEach(n => n.remove());
        notification.classList.add('notification');

        form.prepend(notification);

        setTimeout(() => {
            notification.remove();
        }, 5000);
    }

    // === Validation ===
    function validateForm(formData) {
        const errors = {};

        if (!formData.name?.trim()) {
            errors.name = 'Full Name is required.';
        }
        if (!formData.email?.trim()) {
            errors.email = 'Email Address is required.';
        } else if (!/^\S+@\S+\.\S+$/.test(formData.email)) {
            errors.email = 'Please enter a valid email address.';
        }
        if (!formData.subject?.trim()) {
            errors.subject = 'Subject is required.';
        }
        if (!formData.message?.trim()) {
            errors.message = 'Message is required.';
        } else if (formData.message.length > 2000) {
            errors.message = 'Message is too long. Maximum characters is 2000.';
        }

        return errors;
    }

    // === Submit Handler ===
    if (form) {
        form.addEventListener('submit', async function(e) {
            e.preventDefault();

            // Remove any existing error messages
            document.querySelectorAll('.error-message').forEach(el => el.remove());

            let formData;
            try {
                formData = {
                    name: document.getElementById('name')?.value || '',
                    email: document.getElementById('email')?.value || '',
                    subject: document.getElementById('subject')?.value || '',
                    message: document.getElementById('message')?.value || ''
                };
            } catch (err) {
                console.error("Form field error:", err);
                showNotification("Form fields are missing. Please reload the page. ❌");
                return;
            }

            const validationErrors = validateForm(formData);

            if (Object.keys(validationErrors).length > 0) {
                for (const field in validationErrors) {
                    const errorMessage = document.createElement('p');
                    errorMessage.className = 'text-red-500 text-sm mt-1 error-message';
                    errorMessage.textContent = validationErrors[field];
                    const fieldElement = document.getElementById(field);
                    if (fieldElement) {
                        fieldElement.insertAdjacentElement('afterend', errorMessage);
                    }
                }
                showNotification('Please correct the errors in the form. ❌');
                return;
            }

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        ...(csrftoken ? { 'X-CSRFToken': csrftoken } : {})
                    },
                    body: JSON.stringify(formData)
                });

                if (!response.ok) {
                    let errorData;
                    try {
                        errorData = await response.json();
                    } catch {
                        throw new Error("Invalid server response");
                    }
                    throw new Error(JSON.stringify(errorData));
                }

                const data = await response.json();
                showNotification('✅ Thank you for your message! We will get back to you within 24 hours.', true);
                form.reset();

            } catch (error) {
                console.error('Submission Error:', error);
                try {
                    const errorObj = JSON.parse(error.message);
                    if (typeof errorObj === 'object') {
                        const errorMessages = Object.values(errorObj).flat().join(' ');
                        showNotification(`Error: ${errorMessages} ❌`);
                    } else {
                        showNotification('⚠️ An unexpected server error occurred.');
                    }
                } catch (e) {
                    showNotification('⚠️ Network error. Please check your connection and try again.');
                }
            }
        });
    }

    // === Mobile Menu Toggle ===
    const menuButton = document.getElementById('mobile-menu-button');
    if (menuButton) {
        menuButton.addEventListener('click', function() {
            const menu = document.getElementById('mobile-menu');
            if (menu) menu.classList.toggle('hidden');
        });
    }

    // === Contact Card Hover Effects ===
    document.querySelectorAll('.contact-card').forEach(card => {
        card.addEventListener('mouseenter', function() {
            this.style.boxShadow = '0 10px 25px -5px rgba(0, 0, 0, 0.1)';
        });
        card.addEventListener('mouseleave', function() {
            this.style.boxShadow = '';
        });
    });
</script>
{% endblock script %}

